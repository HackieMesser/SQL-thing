select count(low)
from tutorial.aapl_historical_stock_price

select sum(open)/count(open) as avg_open  from tutorial.aapl_historical_stock_price

select year, month, max(high), min(low) from tutorial.aapl_historical_stock_price group by year, month order by year, month 


select month, year, max(high), min(low) from tutorial.aapl_historical_stock_price group by month, year having max(high)>700 order by month, year 

select player_name, year,  case when year = 'SR' then 'Senior' else 'not senior' end as "senior guyyy" from benn.college_football_players order by "senior guyyy" desc

select player_name, state,  case when state = 'CA' then 'yes' else NULL end as "caliorno" from benn.college_football_players order by 3 

SELECT player_name,
       weight,
       CASE WHEN weight > 250 THEN 'over 250'
            WHEN weight > 200 THEN '201-250'
            WHEN weight > 175 THEN '176-200'
            ELSE '175 or under' END AS weight_group
  FROM benn.college_football_players

SELECT player_name, height, case when height > 80 then 'tall!' else  'short' end as "tall or nah" from benn.college_football_players order by "tall or nah" desc

select *, case when year in ('JR', 'SR') then player_name else null end as "upperclassmen" 
from benn.college_football_players


#Write a query that counts the number of 300lb+ players for each of the following regions: West Coast (CA, OR, WA), Texas, and Other (everywhere else).

SELECT CASE WHEN state in ('CA', 'OR', 'WA')  THEN 'West Coast'
           when state = 'TX'  then 'Texas'
           ELSE  'Other' end as Region, count(*) as "big boys"
  FROM benn.college_football_players
  where weight >=300
   group by Region

#Write a query that calculates the combined weight of all underclass players (FR/SO) in California as well as the combined weight of all upperclass players (JR/SR) in California.


select case when year = 'FR' or year = 'SO' then 'Underclassmen'
when year in ('JR','SR') then 'Upperclassmen'
end as upper_or_under_classmen, sum(weight) as sum_of_weight
from benn.college_football_players
where state = 'CA'
group by upper_or_under_classmen

#does a horizontal to vertical orientation

select state, count(case when year in ('FR','SO') 
then 1 else null end) as under_count,
 count(case when year in ('JR','SR') 
then 1 else null end) as upper_count,
count(year) as total
from benn.college_football_players
group by state 
order by total desc
